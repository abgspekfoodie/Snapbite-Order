<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Snapbite™ Order Form</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 2rem; }
  h1 { color: #ff9500; }
  label { display: block; margin-top: 1rem; font-weight: bold; }
  select, input[type=number], input[type=text], input[type=tel] {
    width: 100%; padding: 8px; border-radius: 5px; border: none; background: #222; color: #fff; margin-top: 5px;
  }
  .menu-block {
    background: #1e1e1e; padding: 1rem; margin-top: 1rem; border-radius: 10px;
  }
  .addons, .sauces {
    margin-top: 0.5rem;
  }
  .addons label, .sauces label {
    font-weight: normal;
    display: inline-block;
    margin-right: 1rem;
  }
  .summary {
    margin-top: 2rem; background: #222; padding: 1rem; border-radius: 10px;
  }
  .submit-btn {
    background: #ff9500; color: #000; border: none; padding: 12px; width: 100%; font-weight: bold; margin-top: 1rem; cursor: pointer;
    border-radius: 5px;
  }
</style>
</head>
<body>

<h1>Snapbite™ Live Order</h1>

<form id="orderForm">

  <label>Name</label>
  <input type="text" id="custName" required />

  <label>Phone</label>
  <input type="tel" id="custPhone" required />

  <div id="menuContainer"></div>
  <button type="button" onclick="addMenu()">+ Add Menu Item</button>

  <label>Notes</label>
  <textarea id="notes" rows="3" style="width: 100%; background:#222; color:#fff; border:none; border-radius:5px;"></textarea>

  <div class="summary">
    <strong>Order Summary:</strong>
    <ul id="orderSummary"></ul>
    <p><strong>Total: RM <span id="totalPrice">0.00</span></strong></p>
  </div>

  <button type="submit" class="submit-btn">Submit Order (WhatsApp + Save)</button>
</form>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB_gnrfNMlJaNu6zSZqX7eiXzbZrnmtA2M",
  authDomain: "snapbite-admin.firebaseapp.com",
  databaseURL: "https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "snapbite-admin",
  storageBucket: "snapbite-admin.appspot.com",
  messagingSenderId: "146625734660",
  appId: "1:146625734660:web:23ada593e4818ed7332d51",
  measurementId: "G-7RR3W1WJYK"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const menusByCategory = {
  "Beef": [
    { id: "primebite", emoji: "🥩", name: "Primebite™", price: 10.00 },
    { id: "beefncheese", emoji: "🧀", name: "Beef N' Cheese™", price: 11.00 },
    { id: "thefunguy", emoji: "🍄", name: "The Fun Guy™", price: 13.00 },
    { id: "thefixer", emoji: "🥓🍳", name: "The Fixer™", price: 15.00 }
  ],
  "Chicken": [
    { id: "chickbite", emoji: "🍗", name: "Chickbite™", price: 5.00 },
    { id: "goldcut", emoji: "🧀", name: "Goldcut™", price: 6.00 },
    { id: "thecapcut", emoji: "🍄", name: "The Cap Cut™", price: 8.00 },
    { id: "stripstack", emoji: "🥓🧀", name: "Stripstack™", price: 9.00 }
  ],
  "Tex-Mex": [
    { id: "smokebeeftaco", emoji: "🌮", name: "Smoke Beef Taco™", price: 11.00 },
    { id: "smokeychoptaco", emoji: "🌮", name: "Smokey Chop Taco™", price: 9.00 },
    { id: "mixtaco", emoji: "🌮", name: "Mix Taco™", price: 12.00 },
    { id: "smokebeefquesadilla", emoji: "🫔", name: "Smoke Beef Quesadilla™", price: 16.00 },
    { id: "smokechickenquesadilla", emoji: "🫔", name: "Smoke Chicken Quesadilla™", price: 14.00 },
    { id: "mixquesadilla", emoji: "🫔", name: "Mix Quesadilla™", price: 17.00 }
  ],
  "Sausage": [
    { id: "classicsausage", emoji: "🌭", name: "Classic Sausage™", price: 7.00 },
    { id: "chickola", emoji: "🍗", name: "Chickola™", price: 8.00 }
  ]
};

const addons = [
  { id: "cheese", emoji: "🧀", name: "Cheese", price: 2.00 },
  { id: "egg", emoji: "🍳", name: "Egg", price: 1.00 },
  { id: "bacon", emoji: "🥓", name: "Bacon", price: 3.00 },
  { id: "mushroom", emoji: "🍄", name: "Mushroom", price: 2.50 }
];

const sauces = [
  "🌶️🌶️ Redriot",
  "🌶️ Whiteblaze"
];

let menuCount = 0;

function addMenu() {
  const id = menuCount++;
  const container = document.createElement('div');
  container.className = 'menu-block';
  container.dataset.id = id;

  let html = `<label>Menu Item</label><select onchange="updateSummary()" class="menu-select" data-id="${id}" required>
    <option value="">-- Select Menu --</option>`;

  for (const [cat, items] of Object.entries(menusByCategory)) {
    html += `<optgroup label="${cat}">`;
    items.forEach(menu => {
      html += `<option value="${menu.id}">${menu.emoji} ${menu.name} – RM${menu.price.toFixed(2)}</option>`;
    });
    html += `</optgroup>`;
  }

  html += '</select>';

  html += `<label>Quantity</label><input type="number" min="1" value="1" onchange="updateSummary()" class="menu-qty" data-id="${id}" required />`;

  html += '<div class="addons"><label>Add-ons</label><br>';
  addons.forEach(addon => {
    html += `<label><input type="checkbox" data-id="${id}" data-addon-id="${addon.id}" data-addon-price="${addon.price}" onchange="updateSummary()"> ${addon.emoji} ${addon.name} RM${addon.price.toFixed(2)}</label>`;
  });
  html += '</div>';

  html += '<div class="sauces"><label>Choice of Sauce</label><br>';
  sauces.forEach((sauce, i) => {
    html += `<label><input type="radio" name="sauce-${id}" value="${sauce}" onchange="updateSummary()"> ${sauce}</label>`;
  });
  html += '</div>';

  container.innerHTML = html;
  document.getElementById('menuContainer').appendChild(container);

  updateSummary();
}

function findMenuById(id) {
  for (const items of Object.values(menusByCategory)) {
    for (const menu of items) {
      if (menu.id === id) return menu;
    }
  }
  return null;
}

function updateSummary() {
  let total = 0;
  let summaryHtml = '';

  const blocks = document.querySelectorAll('.menu-block');
  blocks.forEach(block => {
    const select = block.querySelector('select.menu-select');
    const qty
