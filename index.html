<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snapbite‚Ñ¢ Live Order</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #0e0e0e;
      color: #fff;
      padding: 1.5rem;
      max-width: 600px;
      margin: auto;
      position: relative;
      min-height: 100vh;
    }
    h1 {
      color: #ff9500;
      text-align: center;
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: 600;
    }
    select, input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: none;
      background: #1c1c1c;
      color: #fff;
      font-size: 1rem;
    }
    .menu-block {
      background: #1a1a1a;
      padding: 15px;
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(255, 149, 0, 0.15);
      position: relative;
    }
    .menu-block .remove-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff3b3b;
      border: none;
      color: #fff;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .addons ul, .sauces ul {
      list-style: none;
      padding-left: 0;
      margin-top: 8px;
    }
    .addons li, .sauces li {
      margin-bottom: 8px;
    }
    .summary {
      background: #222;
      padding: 15px;
      border-radius: 10px;
      margin-top: 25px;
    }
    .summary h3 {
      margin-top: 0;
      color: #ff9500;
    }
    button.submit-btn, button.add-menu-btn {
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      border: none;
      font-size: 1rem;
      margin-top: 20px;
      cursor: pointer;
    }
    button.submit-btn {
      background: #ff9500;
      color: #000;
      font-weight: bold;
    }
    button.add-menu-btn {
      background: #007aff;
      color: #fff;
    }
    .closed-msg {
      text-align: center;
      background: #1a1a1a;
      padding: 30px 20px;
      margin-top: 30px;
      border-radius: 16px;
      color: #ff6b6b;
      font-size: 1.1rem;
      line-height: 1.6;
      box-shadow: 0 0 12px rgba(255, 107, 107, 0.2);
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB_gnrfNMlJaNu6zSZqX7eiXzbZrnmtA2M",
      authDomain: "snapbite-admin.firebaseapp.com",
      databaseURL: "https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "snapbite-admin",
      storageBucket: "snapbite-admin.appspot.com",
      messagingSenderId: "146625734660",
      appId: "1:146625734660:web:23ada593e4818ed7332d51"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();const menuData = {
  "Beef": [
    { id: "primebite", name: "Primebite‚Ñ¢", price: 10 },
    { id: "beefncheese", name: "Beef N‚Äô Cheese‚Ñ¢", price: 11 },
    { id: "thefunguy", name: "The Fun Guy‚Ñ¢", price: 13 },
    { id: "thefixer", name: "The Fixer‚Ñ¢", price: 15 }
  ],
  "Chicken": [
    { id: "chickbite", name: "Chickbite‚Ñ¢", price: 5 },
    { id: "goldcut", name: "Goldcut‚Ñ¢", price: 6 },
    { id: "thecapcut", name: "The Cap Cut‚Ñ¢", price: 8 },
    { id: "stripstack", name: "Stripstack‚Ñ¢", price: 9 }
  ],
  "Tex-Mex": [
    { id: "smokebeeftaco", name: "Smoke Beef Taco‚Ñ¢", price: 11 },
    { id: "smokeychickentaco", name: "Smokey Chicken Taco‚Ñ¢", price: 9 },
    { id: "mixtaco", name: "Mix Taco‚Ñ¢", price: 12 },
    { id: "smokebeequesadilla", name: "Smoke Beef Quesadilla‚Ñ¢", price: 16 },
    { id: "smokechickenquesadilla", name: "Smoke Chicken Quesadilla‚Ñ¢", price: 14 },
    { id: "mixquesadilla", name: "Mix Quesadilla‚Ñ¢", price: 16 }
  ],
  "Sausage": [
    { id: "classicsausage", name: "Classic Sausage‚Ñ¢", price: 6 },
    { id: "loadedsausage", name: "Loaded Sausage‚Ñ¢", price: 12 }
  ],
  "Snack": [
    { id: "popcornchicken", name: "Popcorn Chicken‚Ñ¢", price: 7 }
  ]
};

const addonsData = {
  "Beef": [
    { id: "cheese", label: "Cheese", price: 2 },
    { id: "egg", label: "Egg", price: 1 },
    { id: "bacon", label: "Bacon", price: 3 }
  ],
  "Chicken": [
    { id: "cheese", label: "Cheese", price: 2 },
    { id: "egg", label: "Egg", price: 1 },
    { id: "chickenbacon", label: "Chicken Bacon", price: 2 }
  ],
  "Sausage": [
    { id: "cheese", label: "Cheese", price: 2 },
    { id: "bacon", label: "Bacon", price: 3 }
  ]
};

const saucesData = [
  "Nancho Cheese",
  "Snapbite Special",
  "Redriot",
  "Garlic Ranch"
];

function addMenu() {
  const block = document.createElement("div");
  block.className = "menu-block";

  let html = `<button type="button" class="remove-btn" onclick="this.parentElement.remove(); updateSummary();">Remove</button>`;
  html += `<label>Category</label><select onchange="populateItems(this)">`;
  html += `<option value="">-- Select Category --</option>`;
  for (const cat in menuData) html += `<option value="${cat}">${cat}</option>`;
  html += `</select>`;

  html += `<label>Item</label><select disabled><option>-- Select Item --</option></select>`;
  html += `<label>Quantity</label><input type="number" value="1" min="1" onchange="updateSummary()">`;

  html += `<div class="addons" style="display:none"><label>Add-ons</label><ul></ul></div>`;

  html += `<fieldset class="sauces"><legend><strong>Choose up to 2 Sauces</strong></legend><ul>`;
  saucesData.forEach(s => html += `<li><label><input type="checkbox" onchange="limitSauce(this)" value="${s}"> ${s}</label></li>`);
  html += `</ul></fieldset>`;

  block.innerHTML = html;
  document.getElementById("menuContainer").appendChild(block);
}

function populateItems(sel) {
  const block = sel.closest(".menu-block");
  const itemSel = block.querySelector("select:nth-of-type(2)");
  const cat = sel.value;
  itemSel.innerHTML = `<option value="">-- Select Item --</option>`;
  if (cat && menuData[cat]) {
    menuData[cat].forEach(m => {
      itemSel.innerHTML += `<option data-price="${m.price}" value="${m.name}">${m.name} (RM${m.price})</option>`;
    });
    itemSel.disabled = false;
  }

  const addonsDiv = block.querySelector(".addons");
  const addonList = addonsDiv.querySelector("ul");
  addonList.innerHTML = "";
  if (addonsData[cat]) {
    addonsData[cat].forEach(add => {
      addonList.innerHTML += `<li><label><input type="checkbox" data-price="${add.price}" onchange="updateSummary()"> ${add.label} (RM${add.price})</label></li>`;
    });
    addonsDiv.style.display = "block";
  } else {
    addonsDiv.style.display = "none";
  }

  updateSummary();
}

function limitSauce(input) {
  const group = input.closest(".sauces");
  const checks = group.querySelectorAll("input[type=checkbox]:checked");
  if (checks.length > 2) {
    input.checked = false;
    alert("Max 2 sauces only.");
  }
  updateSummary();
}

function updateSummary() {
  const summary = document.getElementById("orderSummary");
  summary.innerHTML = "";
  let total = 0;

  document.querySelectorAll(".menu-block").forEach(block => {
    const itemSel = block.querySelector("select:nth-of-type(2)");
    const qty = parseInt(block.querySelector("input[type=number]").value || 1);
    if (!itemSel || !itemSel.value) return;

    const name = itemSel.value;
    const price = parseFloat(itemSel.options[itemSel.selectedIndex].dataset.price);
    let line = `${name} x${qty}`;

    let addPrice = 0;
    const adds = block.querySelectorAll(".addons input:checked");
    if (adds.length > 0) {
      line += " + " + Array.from(adds).map(a => a.parentElement.textContent.trim()).join(", ");
      addPrice = Array.from(adds).reduce((sum, a) => sum + parseFloat(a.dataset.price), 0);
    }

    const sauces = block.querySelectorAll(".sauces input:checked");
    if (sauces.length > 0) {
      line += " [" + Array.from(sauces).map(s => s.value).join(", ") + "]";
    }

    const subtotal = (price + addPrice) * qty;
    total += subtotal;

    summary.innerHTML += `<li>${line} = RM${subtotal.toFixed(2)}</li>`;
  });

  document.getElementById("totalPrice").textContent = total.toFixed(2);
}

document.addEventListener("DOMContentLoaded", () => {
  db.ref("settings/offday").on("value", snap => {
    const isOff = snap.val() === true;
    document.getElementById("orderForm").style.display = isOff ? "none" : "block";
    document.getElementById("closedMsg").style.display = isOff ? "block" : "none";
  });
});

  </script>
</head>
<body>
  <h1>Snapbite‚Ñ¢ Live Order</h1>
  <div id="closedMsg" class="closed-msg" style="display: none;">
    üîí <strong>We‚Äôre closed for now</strong><br><br>
    The grills are off, the spatulas are resting,<br>
    but Snapbite‚Ñ¢ will be back sizzling soon!<br><br>
    Stay juicy, stay tuned. üçîüî•
  </div>
  <form id="orderForm" style="display: none;">
    <label for="custName">Name</label>
    <input type="text" id="custName" required placeholder="Your name" />
    <label for="custPhone">Phone</label>
    <input type="tel" id="custPhone" required placeholder="Your phone number" pattern="[0-9+]+" />
    <div id="menuContainer"></div>
    <button type="button" class="add-menu-btn" onclick="addMenu()">+ Add Menu Item</button>
    <label for="notes">Notes</label>
    <textarea id="notes" rows="3" placeholder="Extra instructions (optional)"></textarea>
    <div class="summary">
      <h3>Order Summary</h3>
      <ul id="orderSummary"></ul>
      <p><strong>Total: RM <span id="totalPrice">0.00</span></strong></p>
    </div>
    <button type="submit" class="submit-btn">Submit Order</button>
  </form>
</body>
</html>
