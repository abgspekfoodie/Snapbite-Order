<!DOCTYPE html>  <html lang="en">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width, initial-scale=1" />  
  <title>Snapbite‚Ñ¢ Live Order</title>  
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>  
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>  
  <style>  
    body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 1.5rem; max-width: 600px; margin: auto; }  
    h1 { color: #ff9500; text-align: center; margin-bottom: 1rem; }  
    label { display: block; margin-top: 1rem; font-weight: bold; }  
    select, input, textarea {  
      width: 100%; padding: 8px; margin-top: 5px; border-radius: 6px; border: none;  
      background: #222; color: #fff; font-size: 1rem;  
    }  
    .menu-block {  
      background: #1e1e1e; padding: 15px; margin-top: 20px; border-radius: 10px; position: relative;  
    }  
    .menu-block .remove-btn {  
      position: absolute; top: 10px; right: 10px; background: #ff3b3b; border: none; color: #fff;  
      padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;  
    }  
    .addons label, .sauces label {  
      display: inline-block; margin-right: 12px; font-size: 0.9rem; font-weight: normal;  
    }  
    .summary {  
      background: #222; padding: 15px; border-radius: 10px; margin-top: 25px;  
    }  
    .summary h3 { margin-top: 0; color: #ff9500; }  
    button.submit-btn, button.add-menu-btn {  
      width: 100%; padding: 15px; border-radius: 10px; border: none; font-size: 1rem; margin-top: 20px;  
    }  
    button.submit-btn { background: #ff9500; color: #000; font-weight: bold; }  
    button.add-menu-btn { background: #0a84ff; color: #fff; }  
    .closed-msg {  
      text-align: center; background: #330000; padding: 20px; margin-top: 30px;  
      border-radius: 10px; color: #ff6b6b;  
    }  
  </style>  
</head>  
<body>  
  <h1>Snapbite‚Ñ¢ Live Order</h1>    <div id="closedMsg" class="closed-msg" style="display:   <div id="closedMsg" class="closed-msg" style="display: none;">
  üîí Snapbite‚Ñ¢ is clocked out for the day.<br><br>
  No sizzle, no flip, no juicy display. üçîüî•<br><br>
  We're recharging the taste, giving dreams some play,<br>
  But don't you worry ‚Äî we‚Äôre not far away.<br><br>
  üí¨ Stay tuned, stay hype, we‚Äôll be back your way!
</div>
  </div>    <form id="orderForm" style="display: none;">  
    <label for="custName">Name</label>  
    <input type="text" id="custName" required placeholder="Your name" />  <label for="custPhone">Phone</label>  
<input type="tel" id="custPhone" required placeholder="Your phone number" pattern="[0-9+]+" />  

<div id="menuContainer"></div>  
<button type="button" class="add-menu-btn" onclick="addMenu()">+ Add Menu Item</button>  

<label for="notes">Notes</label>  
<textarea id="notes" rows="3" placeholder="Extra instructions (optional)"></textarea>  

<div class="summary">  
  <h3>Order Summary</h3>  
  <ul id="orderSummary"></ul>  
  <p><strong>Total: RM <span id="totalPrice">0.00</span></strong></p>  
</div>  

<button type="submit" class="submit-btn">Submit Order</button>

  </form>    <script>  
    // Firebase config  
    const firebaseConfig = {  
      apiKey: "AIzaSyB_gnrfNMlJaNu6zSZqX7eiXzbZrnmtA2M",  
      authDomain: "snapbite-admin.firebaseapp.com",  
      databaseURL: "https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app",  
      projectId: "snapbite-admin",  
      storageBucket: "snapbite-admin.appspot.com",  
      messagingSenderId: "146625734660",  
      appId: "1:146625734660:web:23ada593e4818ed7332d51"  
    };  
    firebase.initializeApp(firebaseConfig);  
    const db = firebase.database();  
  
    // Menu  
    const menuData = {    
  "Beef": [    
    { id: "primebite", name: "Primebite‚Ñ¢", price: 10, desc: "Crafted 140g beef patty ‚Äî bold and juicy" },    
    { id: "beefncheese", name: "Beef N‚Äô Cheese‚Ñ¢", price: 11, desc: "140g beef patty topped with melting cheese" },    
    { id: "thefunguy", name: "The Fun Guy‚Ñ¢", price: 12, desc: "Saut√©ed mushrooms meet smoky beef perfection" },    
    { id: "thefixer", name: "The Fixer‚Ñ¢", price: 15, desc: "Stacked with beef, bacon, egg, and cheese" }    
  ],    
  "Chicken": [    
    { id: "chickbite", name: "Chickbite‚Ñ¢", price: 9, desc: "Golden fried chicken thigh ‚Äî pure crunch" },    
    { id: "goldcut", name: "Goldcut‚Ñ¢", price: 10, desc: "Fried chicken layered with gooey cheese" },    
    { id: "thecapcut", name: "The Cap Cut‚Ñ¢", price: 11, desc: "Golden fried chicken topped with mushrooms" },    
    { id: "stripstack", name: "Stripstack‚Ñ¢", price: 14, desc: "Chicken bacon and cheese, all in one bite" },
    { id: "popcornchicken", name: "Popcorn Chicken‚Ñ¢", price: 7, desc: "Crispy golden chicken pops ‚Äî snack-ready" }  
  ],    
  "Tex-Mex": [    
    { id: "smokebeeftaco", name: "Smoke Beef Taco‚Ñ¢", price: 10, desc: "Smoked beef, rich with Tex-Mex punch" },    
    { id: "smokeychickentaco", name: "Smokey Chicken Taco‚Ñ¢", price: 9, desc: "Tender smoked chicken with bold flavour" },    
    { id: "mixtaco", name: "Mix Taco‚Ñ¢", price: 12, desc: "Beef and chicken ‚Äî split the best worlds" },    
    { id: "smokebeequesadilla", name: "Smoke Beef Quesadilla‚Ñ¢", price: 15, desc: "Cheesy quesadilla with smoky beef" },    
    { id: "smokechickenquesadilla", name: "Smoke Chicken Quesadilla‚Ñ¢", price: 14, desc: "Quesadilla packed with smoky chicken" },    
    { id: "mixquesadilla", name: "Mix Quesadilla‚Ñ¢", price: 16, desc: "Cheesy, meaty ‚Äî half beef, half chicken" }    
  ],    
  "Sausage": [    
  { 
    id: "classicsausage", 
    name: "Classic Sausage‚Ñ¢", 
    price: 7, 
    desc: "Grilled sausage in soft glazed bun ‚Äî simple, timeless" 
  },    
  { 
    id: "loadedsausage", 
    name: "Loaded Sausage‚Ñ¢", 
    price: 9, 
    desc: "One bite in, and you‚Äôll know why we call it *loaded*" 
  }    
]
  
    const addonsData = [
  { id: "cheese", label: "Cheese", price: 2 },
  { id: "egg", label: "Egg", price: 1 },
  { id: "bacon", label: "Bacon", price: 3 }
];

const saucesData = [
  { id: "nancho", label: "Nancho Cheese", desc: "Rich, creamy cheddar-style cheese sauce ‚Äî best with chicken" },
  { id: "special", label: "Snapbite Special", desc: "Zesty layered sauce with tangy twist ‚Äî best for beef" },
  { id: "redriot", label: "Redriot", desc: "Crafted chili-based sauce with a kick" },
  { id: "garlicranch", label: "Garlic Ranch", desc: "Smooth, garlicky and herby ranch" }
];
  
    let menuCount = 0;  
  
    function addMenu() {  
      const container = document.getElementById("menuContainer");  
      const block = document.createElement("div");  
      block.className = "menu-block";  
      block.dataset.id = menuCount;  
  
      let html = `<button type="button" class="remove-btn" onclick="removeMenu(${menuCount})">Remove</button>`;  
      html += `<label>Category</label><select class="category" onchange="onCategoryChange(this)" required><option value="">-- Select Category --</option>`;  
      Object.keys(menuData).forEach(cat => html += `<option value="${cat}">${cat}</option>`);  
      html += `</select>`;  
  
      html += `<label>Menu Item</label><select class="menu" disabled required><option value="">-- Select Item --</option></select>`;  
      html += `<label>Quantity</label><input type="number" class="qty" value="1" min="1" onchange="updateSummary()">`;  
  
      html += `<div class="addons" style="margin-top: 1rem;">
  <label style="font-weight: bold;">Add-ons</label>
  <ul style="list-style: none; padding: 0; margin-top: 0.5rem;">`;
addonsData.forEach(add => {
  html += `<li style="margin-bottom: 6px;">
    <label>
      <input type="checkbox" class="addon" data-label="${add.label}" data-price="${add.price}" onchange="updateSummary()">
      ${add.label} <span style="color: #aaa;">(RM${add.price})</span>
    </label>
  </li>`;
});
html += `</ul></div>`;

html += `<fieldset class="sauces" style="border: none; margin-top: 1rem; padding: 0;">
  <legend style="font-weight: bold; margin-bottom: 0.5rem;">Choose Sauce</legend>
  <ul style="list-style: none; padding: 0;">`;
saucesData.forEach(s => {
  html += `<li style="margin-bottom: 6px;">
    <label>
      <input type="radio" name="sauce-${menuCount}" value="${s.label}" onchange="updateSummary()">
      <strong>${s.label}</strong><br>
      <span style="font-size: 0.85rem; color: #ccc; margin-left: 1.2rem;">${s.desc}</span>
    </label>
  </li>`;
});
html += `</ul></fieldset>`; 
  
      block.innerHTML = html;  
      container.appendChild(block);  
      menuCount++;  
    }  
  
    function removeMenu(id) {  
      const block = document.querySelector(`.menu-block[data-id="${id}"]`);  
      if (block) block.remove();  
      updateSummary();  
    }  
  
    function onCategoryChange(select) {  
      const cat = select.value;  
      const block = select.closest(".menu-block");  
      const menuSelect = block.querySelector(".menu");  
      menuSelect.innerHTML = `<option value="">-- Select Item --</option>`;  
      menuSelect.disabled = !cat;  
      if (cat) {  
        menuData[cat].forEach(item => {  
          menuSelect.innerHTML += `<option value="${item.name}" data-price="${item.price}">${item.name} (RM${item.price})</option>`;  
        });  
      }  
      updateSummary();  
    }  
  
    function updateSummary() {  
      let total = 0;  
      const ul = document.getElementById("orderSummary");  
      ul.innerHTML = "";  
  
      document.querySelectorAll(".menu-block").forEach(block => {  
        const menu = block.querySelector(".menu");  
        const qty = parseInt(block.querySelector(".qty").value || 1);  
        if (!menu || !menu.value) return;  
  
        const itemName = menu.value;  
        const itemPrice = parseFloat(menu.options[menu.selectedIndex].dataset.price);  
        const addons = [...block.querySelectorAll(".addon:checked")].map(a => ({  
          label: a.dataset.label,  
          price: parseFloat(a.dataset.price)  
        }));  
        const sauceInput = block.querySelector('input[type="radio"]:checked');  
        const sauce = sauceInput ? sauceInput.value : "";  
  
        let line = `${itemName} x${qty}`;  
        if (addons.length) line += " + " + addons.map(a => a.label).join(", ");  
        if (sauce) line += ` [${sauce}]`;  
  
        let itemTotal = (itemPrice + addons.reduce((sum, a) => sum + a.price, 0)) * qty;  
        total += itemTotal;  
  
        let li = document.createElement("li");  
        li.textContent = `${line} = RM${itemTotal.toFixed(2)}`;  
        ul.appendChild(li);  
      });  
  
      document.getElementById("totalPrice").textContent = total.toFixed(2);  
    }  
  
    document.getElementById("orderForm").addEventListener("submit", function(e) {  
      e.preventDefault();  
      const name = document.getElementById("custName").value.trim();  
      const phone = document.getElementById("custPhone").value.trim();  
      const notes = document.getElementById("notes").value.trim();  
      if (!name || !phone) return alert("Please enter your name and phone.");  
  
      const items = [];  
      document.querySelectorAll(".menu-block").forEach(block => {  
        const menu = block.querySelector(".menu");  
        const qty = parseInt(block.querySelector(".qty").value || 1);  
        if (!menu || !menu.value) return;  
  
        const itemName = menu.value;  
        const itemPrice = parseFloat(menu.options[menu.selectedIndex].dataset.price);  
        const addons = [...block.querySelectorAll(".addon:checked")].map(a => ({  
          label: a.dataset.label,  
          price: parseFloat(a.dataset.price)  
        }));  
        const sauceInput = block.querySelector('input[type="radio"]:checked');  
        const sauce = sauceInput ? sauceInput.value : "";  
  
        items.push({ name: itemName, quantity: qty, price: itemPrice, addons, sauce });  
      });  
  
      let total = items.reduce((sum, i) =>  
        sum + ((i.price + i.addons.reduce((a, x) => a + x.price, 0)) * i.quantity), 0);  
  
      let msg = `Snapbite Order\nName: ${name}\nPhone: ${phone}\n\nOrder:\n`;  
      items.forEach(i => {  
        let line = `- ${i.name} x${i.quantity}`;  
        if (i.addons.length) line += ` + ${i.addons.map(a => a.label).join(", ")}`;  
        if (i.sauce) line += ` [${i.sauce}]`;  
        msg += line + "\n";  
      });  
      msg += `\nTotal: RM${total.toFixed(2)}`;  
      if (notes) msg += `\nNotes: ${notes}`;  
  
      const order = { name, phone, notes, items, total, status: "pending", time: new Date().toISOString() };  
      db.ref("orders").push(order, err => {  
        if (!err) {  
          window.open("https://wa.me/60173209379?text=" + encodeURIComponent(msg), "_blank");  
          document.getElementById("orderForm").reset();  
          document.getElementById("menuContainer").innerHTML = "";  
          menuCount = 0;  
          addMenu(); updateSummary();  
        }  
      });  
    });  
  
    // Check Off Day  
    db.ref("settings/offday").on("value", snap => {  
      const isOff = snap.val() === true;  
      document.getElementById("orderForm").style.display = isOff ? "none" : "block";  
      document.getElementById("closedMsg").style.display = isOff ? "block" : "none";  
    });  
  
    // Init  
    addMenu();  
  </script>  </body>  
</html>
